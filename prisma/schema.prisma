generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

/// Usuários (vendedor responsável)
model User {
  id        Int      @id @default(autoincrement())
  name      String
  email     String   @unique
  password  String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  leads     Lead[]   @relation("UserLeads")

  @@map("user")
}

/// Leads do CRM
model Lead {
  id               Int       @id @default(autoincrement())
  name             String
  origin           String?
  value            Decimal?  @db.Decimal(12, 2)
  createdAt        DateTime  @default(now())
  updatedAt        DateTime  @updatedAt
  ownerId          Int?
  company          String?
  email            String?
  jobTitle         String?
  notes            String?
  phone            String?   @db.VarChar(30)
  score            Int?      @db.SmallInt
  stage_id         Int?
  opportunityTitle String?   @db.VarChar
  estimatedValue   Decimal?  @db.Decimal(12, 2)
  probability      Int?
  expectedDate     DateTime? @db.Date
  paymentCondition String?
  costCenter       String?   @db.VarChar
  owner            User?     @relation("UserLeads", fields: [ownerId], references: [id])

  @@index([ownerId])
  @@index([email])
  @@index([phone])
  @@map("lead")
}

model funnel_type {
  id   Int    @id @default(autoincrement())
  name String @db.VarChar(30)
}

model stage {
  id             Int    @id(map: "prospec_funnel_pkey") @default(autoincrement())
  name           String @db.VarChar(255)
  position       Int?   @unique(map: "prospec_funnel_unique") @default(autoincrement()) @db.SmallInt
  funnel_type_id Int    @db.SmallInt
}

/// Estágios do funil
enum Stage {
  LEAD
  MQL
  ANALISE_MQL
  SQL
  REUNIAO
  EXCLUIDO
}
